<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Getting started with Bootstrap</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="./bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">

    <link href="./bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.9.6/TweenMax.min.js"></script>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.5.0.min.js"></script>
    <script src="WikipediaTracer.js"></script>

    <script>
        $(document).ready(function(){
          
            $("#input").val("Blue")

            wk = new WikipediaTracer()

            wk.updateCallback = function () {
                
                var latestItem = wk.chain[wk.chain.length - 1]

                var payload = $("<a>").attr("href", latestItem.link).append(latestItem.name)

                var carrier = $("<tr>").addClass("chain-element").append(
                    $("<td>").append(
                        payload
                    )
                ).append(
                    $("<td>").append(
                        ""
                    )
                )
                

                $("#chainBody").append(carrier)

            }

            wk.doneCallback = function () {
                $("#submit").removeAttr("disabled")

                $(".chain-element:eq(" + wk.loopBackIndex + ")").addClass("info")

                var badge = $("<span>").addClass("label label-success").append("Loop!")

                $(".chain-element:eq(" + wk.loopBackIndex + ")").children("td:eq(1)").append(badge)

                var loopElement = wk.chain[wk.loopBackIndex]

                var info = $("<div>").attr("id", "loopInfo").addClass("alert alert-info").append(
                    $("<button>").attr("type", "button").addClass("close").attr("data-dismiss", "alert").append("&times;")
                ).append(
                    "This article loops on: <strong>" + loopElement.name + "</strong>"
                )

                $("#inputWell").after(info)

                $("#loopInfo").css("display", "none")
                $("#loopInfo").slideDown()

            }

            wk.errorCallback = function () {
                var info = $("<div>").attr("id", "errorInfo").addClass("alert alert-warning").append(
                    $("<button>").attr("type", "button").addClass("close").attr("data-dismiss", "alert").append("&times;")
                ).append(
                    "Cannot find an article with this name"
                )

                $("#inputWell").after(info)

                $("#errorInfo").css("display", "none")
                $("#errorInfo").slideDown()

                $("#submit").removeAttr("disabled")
            }

            $("#submit").click(function () {

                $(".chain-element").remove()
                $("#loopInfo,#errorInfo").remove()

                wk.seedFromName($("#input").val())
                $("#submit").attr("disabled", "disabled")
                wk.doTrace()
            })

        });
    </script>

</head>

<body>

<div id="mainContainer" class="container">
    <h2>
        Heading
    </h2>
    <hr>
    <div id="inputWell" class="well">
        <div class="row-fluid">
            <div class="span12">
                <label class="span12">Type the name of the starting Wikipedia Article</label>
            </div>
        </div>
        <div class="row-fluid">
            <div class="span10">
                <input id="input" class="span12" type="text"></input>
            </div>
            <div class="span2">
                <button id="submit" class="btn span12">Submit</button>
            </div>
        </div>
    </div>
    <table id="chainTable" class="table table-striped table-bordered">
        <tbody id="chainBody">
        </tbody>
    </table>
</div>

</body>

</html>